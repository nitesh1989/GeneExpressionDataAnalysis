tG2 <- tG2[order(tG2$ID),]
tG2 <- topTable(eb2.ls, coef=1, number=10, resort="logFC")
tG2
tG
eb2.ls <- eBayes(fit2.ls, proportion=0.01)
eb.ls <- eBayes(fit.ls, proportion=0.01)
eb.ls
all(tG == tG2)
tG2 <- topTable(eb2.ls, coef=1, number=Inf, resort="logFC")
str(tG2)
egid <- mget(tG2$ID, hgu95aENTREZID, ifnotfound=NA)
sym <- mget(tG2$ID, hgu95aSYMBOL, ifnotfound=NA)
nm <- mget(tG2$ID, hgu95aGENENAME, ifnotfound=NA)
tG2ann <- cbind(EGID=unlist(egid), SYMBOL=unlist(sym), GeneName=unlist(nm),
tG2, stringsAsFactors=FALSE)
ann <- select(x=hgu95a.db, keys=tG2$ID,
cols=c("ENTREZID", "SYMBOL", "GENENAME"))
tG2ann <- cbind(EGID=unlist(egid), SYMBOL=unlist(sym), GeneName=unlist(nm),
tG2, stringsAsFactors=FALSE)
### Let's check the results now
str(tG2ann)
ann <- select(x=hgu95a.db, keys=tG2$ID,
cols=c("ENTREZID", "SYMBOL", "GENENAME"))
ann <- select(x=hgu95a.db, keys=tG2$ID,cols=c("ENTREZID", "SYMBOL", "GENENAME"))
str(tG2ann)
tG2ann <- cbind(EGID=unlist(egid), SYMBOL=unlist(sym), GeneName=unlist(nm),
tG2, stringsAsFactors=FALSE)
tG2ann
str(tG2ann)
load("~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/latest_pd.rda")
View(pd)
table(pd$current.asthma)
table(pd$dist150)
table(pd$dist150,pd$current.asthma)
home = "~/Documents/TestRun/Charm Analysis/charmData/Nimblegen_Originals/Asthma_Peru/April18_Asthma_peru/"
setwd(home)
library("pd.100718.hg18.cpg.refseq.prom.medip")
library(charm)
library(BiocInstaller)
library("BSgenome.Hsapiens.UCSC.hg18")
load("April18_Asthma_peru/latest_pd.rda")
drive = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/"
setwd(drive)
#load library
library("pd.100718.hg18.cpg.refseq.prom.medip")
library(charm)
library(charm)
biocLite("charm")
library(charm)
load("April18_Asthma_peru/latest_pd.rda")
drive = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/"
setwd(drive)
load("April18_Asthma_peru/latest_pd.rda")
setwd(drive)
home = "~/Documents/TestRun/Charm Analysis/charmData/Nimblegen_Originals/Asthma_Peru/April18_Asthma_peru/"
setwd(home)
load("April18_Asthma_peru/latest_pd.rda")
load("../April18_Asthma_peru/latest_pd.rda")
load("latest_pd.rda")
drive = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/"
setwd(drive)
load("latest_pd.rda")
xys = list.files("April18_Asthma_peru/",pattern= ".xys")
pd = pd[-61,]
View(pd)
rawData = readCharm(files = pd$filename,path = "April18_Asthma_peru",ut = "_635.xys",md = "_532.xys")
home = "~/Documents/TestRun/Charm Analysis/charmData/Nimblegen_Originals/Asthma_Peru/April18_Asthma_peru/"
setwd(home)
rawData = readCharm(files = pd$filename,path = "April18_Asthma_peru",ut = "_635.xys",md = "_532.xys")
pData(rawData)$current.asthma = pd[match(rownames(pData(rawData)),substr(pd$filename,1,4)),"current.asthma"]
pd = pd[-61,]
load("latest_pd.rda")
home = "~/Documents/TestRun/Charm Analysis/charmData/Nimblegen_Originals/Asthma_Peru/April18_Asthma_peru/"
setwd(home)
load("latest_pd.rda")
drive = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/"
setwd(drive)
load(file.path(drive,"latest_pd.rda"))
home = "~/Documents/TestRun/Charm Analysis/charmData/Nimblegen_Originals/Asthma_Peru/April18_Asthma_peru/"
setwd(home)
load(file.path(drive,"latest_pd.rda"))
xys = list.files("April18_Asthma_peru/",pattern= ".xys")
pd = pd[-61,]
rawData = readCharm(files = pd$filename,path = "April18_Asthma_peru",ut = "_635.xys",md = "_532.xys")
xys = list.files(".",pattern= ".xys")
pd = pd[-61,]
rawData = readCharm(files = pd$filename,path = "April18_Asthma_peru",ut = "_635.xys",md = "_532.xys")
View(pd)
load(file.path(drive,"latest_pd.rda"))
pd = pd[-61,]
rawData = readCharm(files = pd$filename,path = "April18_Asthma_peru",ut = "_635.xys",md = "_532.xys")
home = "~/Documents/TestRun/Charm Analysis/charmData/Nimblegen_Originals/Asthma_Peru/"
setwd(home)
load(file.path(drive,"latest_pd.rda"))
# xys = list.files("April18_Asthma_peru/",pattern= ".xys")
xys = list.files("April18_Asthma_peru/",pattern= ".xys")
pd = pd[-61,]
rawData = readCharm(files = pd$filename,path = "April18_Asthma_peru",ut = "_635.xys",md = "_532.xys")
pData(rawData)$current.asthma = pd[match(rownames(pData(rawData)),substr(pd$filename,1,4)),"current.asthma"]
pData(rawData)$dist150 = pd[match(rownames(pData(rawData)),substr(pd$filename,1,4)),"dist150"]
library(BiocInstaller)
library("BSgenome.Hsapiens.UCSC.hg18")
pData(rawData)
dim(pData(rawData))
pd_vitd = read.csv("April18_Asthma_peru/results/pd_peru_may1.csv")
View(pd_vitd)
View(pd_vitd)
View(pd_vitd)
pd_vitd$Sample_ID
pData(rawData)$vitd = pd[match(rownames(pData(rawData)),pd_vitd$Sample_ID,"vitd"]
pData(rawData)$vitd = pd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"vitd"]
View(pd)
pData(rawData)
match(rownames(pData(rawData)),pd_vitd$Sample_ID
)
pd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"vitd"]
pd_vitd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"vitd"]
pData(rawData)$vitd = pd_vitd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"vitd"]
pData(rawData)
which(pd_vitd$vitd == NA)
which(is.na(pd_vitd$vitd))
is.na(pd_vitd$vitd))
is.na(pd_vitd$vitd)
pd_vitd$vitd[which(is.na(pd_vitd$vitd))] = 0
View(pd_vitd)
pData(rawData)$vitd = pd_vitd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"vitd"]
save(pData(rawData),file = "April18_Asthma_peru/results/pd_including_vitd.rda")
pd = pData(rawData)
save(pd,file = "April18_Asthma_peru/results/pd_including_vitd.rda")
View(pd)
ctrlIdx = getControlIndex(rawData,subject = Hsapiens)
pmq <- charm::pmQuality(rawData)
chr=pmChr(rawData)
pns=probeNames(rawData)
seq = pmSequence(rawData)
pos=pmPosition(rawData)
rmpmq = rowMeans(pmq)
okqc = which(rmpmq>75)
p = methp(rawData,controlIndex = ctrlIdx)
pData(rawData)$qual= qual[,1]
load("April18_Asthma_peru/results/qual.rda")
pData(rawData)$qual= qual[,1]
pd = pData(rawData)
View(pd)
oo = order(chr,pos)
p0 =p
p = p[oo,]
seq = seq[oo]
pos = pos[oo]
pns = pns[oo]
chr=chr[oo]
pns = clusterMaker(chr,pos)
pns = pns[oo]
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$vitd)
View(mod)
coeff = 2
thedmrs_vitd = dmrFind(p=p, mod=mod, mod0=mod0, coeff=coeff, pns=pns, chr=chr, pos=pos)
cpg.cur = read.delim("http://rafalab.jhsph.edu/CGI/model-based-cpg-islands-hg18.txt",as.is=TRUE)
library(corpcor)
save(thedmrs_vitd,file = "April18_Asthma_peru/results/dmrs_vitd.rda")
thedmrs_vitd$dmrs
write.csv(thedmrs_vitd$dmrs,file="April18_Asthma_peru/results/dmrs_vitd.csv")
pd$vitd
summary(pd$vitd)
mod[,coeff]
groups = as.numeric(cut(mod[,coeff],c(0,16,22,Inf)))
groups
groups = as.numeric(cut(mod[,coeff],c(-Inf,16,22,Inf)))
groups
table(groups)
pd$groups = c("low","medium","high")[groups]
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups,outfile="April18_Asthma_peru/results/dmrs_vitd.pdf", which_plot=c(1:5), smoo="loess", ADD=3000,cols=c("black","blue","red"))
vignette("charm")
thedmrs_vitd$dmrs
pd$groups
dmr <- dmrFinder(rawData, p=p0, groups=pd$groups,compare=c("high","medium","low"),
removeIf=expression(nprobes<4 | abs(diff)<.05 | abs(maxdiff)<.05))
dim(pd)
quarters(pd$vitd)
quantile(pd$vitd)
View(pd)
View(pd_vitd)
pd_vitd = read.csv("April18_Asthma_peru/results/pd_peru_may1.csv")
View(pd_vitd)
pData(rawData)dist = pd_vitd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"dist"]
pData(rawData)$dist = pd_vitd[match(rownames(pData(rawData)),pd_vitd$Sample_ID),"dist"]
pd = pData(rawData)
View(pd)
save(pd,file = "April18_Asthma_peru/results/pd_including_vitd_distance.rda")
library(BiocInstaller)
library("BSgenome.Hsapiens.UCSC.hg18")
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$vitd)
quantiles(pd$vitd)
quantile(pd$vitd)
summar(pd$vitd)
summary(pd$vitd)
quantile(pd$vitd)
cut(mod[,coeff]
)
cut(mod[,coeff],c(-Inf,16,22,Inf))
groups = as.numeric(cut(mod[,coeff],quantile(pd$vitd)))
groups
which(is.na(groups))
pd$vitd[21]
pd$groups[c(21,29)] = 1
groups
groups[21] =1
groups[29] =1
table(groups)
pd$groups = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
table(groups)
table(pd$groups)
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups,outfile="April18_Asthma_peru/results/dmrs_vitd_quantiles.pdf", which_plot=c(1:5), smoo="loess", ADD=3000,cols=c("black","blue","red","green"))
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$dist)
mod
coeff = 2
thedmrs_dist = dmrFind(p=p, mod=mod, mod0=mod0, coeff=coeff, pns=pns, chr=chr, pos=pos)
quantile(pd$dist)
groups = as.numeric(cut(mod[,coeff],quantile(pd$dist)))
table(groups)
cut(mod[,coeff],quantile(pd$dist))
View(pd)
?plotDMRs
pd$dist
which(is.na(groups))
pd$dist[28]
groups
groups[28] = 1
ls()
gourps
groups
table(groups)
pd$groups_distance = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
View(pd)
table(pd$groups_distance)
pd$groups_distance = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
table(pd$groups_distance)
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups_distance,outfile="April18_Asthma_peru/results/dmrs_distance_quantiles.pdf", which_plot=c(1:5), smoo="loess", ADD=3000,cols=c("black","blue","red","orange"))
pd$groups_distance = c("31.7 - 103", "103 - 172","172 - 527","527 - 893")
table(pd$groups_distance)
pd$groups_distance = c("31.7m - 103m", "103m - 172m","172m - 527m","527m - 893m")
table(pd$groups_distance)
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups_distance,outfile="April18_Asthma_peru/results/dmrs_distance_quantiles_renamed.pdf", which_plot=c(1:5), smoo="loess", ADD=3000,cols=c("black","blue","red","orange"))
quantile(pd$vitd)
table(groups)
cut(mod[,coeff],quantile(pd$vitd))
quantile(pd$vitd)
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$vitd)
cut(mod[,coeff],quantile(pd$vitd))
groups = as.numeric(cut(mod[,coeff],quantile(pd$vitd)))
groups
groups[21] =1
groups[29] =1
table(groups)
c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
pd$groups_vitd = c("0.0 - 16.6","16.6 - 19.8","19.8 - 22.8","22.8 - 32.6")[groups]
table(pd$groups_vitd)
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups_vitd,outfile="April18_Asthma_peru/results/dmrs_vitd_quantiles_renamed.pdf", which_plot=c(1:5), smoo="loess", ADD=3000,cols=c("black","blue","red","green"))
head(chr)
tail(chr)
which(chr == "chrX")
indexChrX = which(chr == "chrX")
indexChrY = which(chr == "chrY")
chr_noxy = chr[-c(indexChrX,indexChrY)]
chr+copy = chr
chr_copy = chr
chr = chr[-c(indexChrX,indexChrY)]
rm(chr)
chr = chr[-c(indexChrX,indexChrY)]
chr = chr_copy[-c(indexChrX,indexChrY)]
rm(chr_noxy)
pns = clusterMaker(chr,pos)
pos = pos[-c(indexChrX,indexChrY)]
pns = clusterMaker(chr,pos)
oo = order(chr,pos)
pns = pns[oo]
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$vitd)
coeff = 2
thedmrs_vitd = dmrFind(p=p, mod=mod, mod0=mod0, coeff=coeff, pns=pns, chr=chr, pos=pos)
thedmrs_vitd$dmrs
summary(thedmrs_vitd$dmrs$nprobes)
save(thedmrs_vitd,file = "April18_Asthma_peru/results/dmrs_vitd_noXY.rda")
write.csv(thedmrs_vitd$dmrs,file="April18_Asthma_peru/results/dmrs_vitd_noXY.csv")
quantile(pd$vitd)
quantile(pd$vitd)
#groups = as.numeric(cut(mod[,coeff],c(-Inf,16,22,Inf)))
groups = as.numeric(cut(mod[,coeff],quantile(pd$vitd)))
# account for the zero values
groups
groups[21] =1
groups[29] =1
table(groups)
pd$groups = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
pd$groups_vitd = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
table(pd$groups_vitd)
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups_vitd,outfile="April18_Asthma_peru/results/dmrs_vitd_quantiles.pdf", which_plot=c(1:200), smoo="loess", ADD=3000,cols=c("black","blue","red","green"))
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$dist)
coeff = 2
thedmrs_dist = dmrFind(p=p, mod=mod, mod0=mod0, coeff=coeff, pns=pns, chr=chr, pos=pos)
save(thedmrs_vitd,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_continous_noXY.rda")
write.csv(thedmrs_vitd$dmrs,file="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_continous_noXY.csv")
quantile(pd$dist)
quantile(pd$dist)
table(groups)
pd$groups_distance = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
table(pd$groups_distance)
plotDMRs(dmrs=thedmrs_vitd, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups_distance,outfile="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_quantiles_renamed.pdf", which_plot=c(1:200), smoo="loess", ADD=3000,cols=c("black","blue","red","orange"))
View(pd)
pd$currentAsthma = ifelse(test=(pd$current.asthma==0),"Normal","Asthma")
mod0 = matrix(1,nrow = nrow(pd),ncol = 1)
mod = model.matrix(~1 + factor(pd$currentAsthma,levels =c("Asthma","Normal")))
library(corpcor)
thedmrs_asthma = dmrFind(p =p,mod =mod,mod0=mod0,coeff=2,pns = pns, chr = chr,pos= pos)
save(thedmrs_asthma,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_currentAsthma_noXY.rda")
write.csv(thedmrs_asthma$dmrs,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_currentAsthma_noXY.csv")
cpg.cur = read.delim("http://rafalab.jhsph.edu/CGI/model-based-cpg-islands-hg18.txt",as.is=TRUE)
plotDMRs(dmrs=thedmrs_asthma, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$currentAsthma,outfile="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_currentAsthma_noXY.pdf", which_plot=c(1:200),which_points=c("Asthma","Normal"), smoo="loess", ADD=3000,cols=c("black","red"))
mod0 = matrix(1,nrow = nrow(pd),ncol = 1)
mod = model.matrix(~1 + factor(pd$distance,levels =c("Over150m","Under150m")))
View(pd)
View(pd)
View(pd)
pd$dist150 = ifelse(test=(pd$dist<0),"Under150m","Over150m")
View(pd)
pd$dist150 = ifelse(test=(pd$dist<150),"Under150m","Over150m")
View(pd)
mod0 = matrix(1,nrow = nrow(pd),ncol = 1)
mod = model.matrix(~1 + factor(pd$dist150,levels =c("Over150m","Under150m")))
thedmrs_distance = dmrFind(p =p,mod =mod,mod0=mod0,coeff=2,pns = pns, chr = chr,pos= pos)
save(thedmrs_asthma,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_dist150_noXY.rda")
save(thedmrs_distance,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_dist150_noXY.rda")
write.csv(thedmrs_distance$dmrs,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_dist150_noXY.csv")
plotDMRs(dmrs=thedmrs_distance, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$tissue,outfile="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_dist150_noXY.pdf", which_plot=c(1:200),which_points=c("Over150m","Under150m"), smoo="loess", ADD=3000,cols=c("black","red"))
plotDMRs(dmrs=thedmrs_distance, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$dist150,outfile="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_dist150_noXY.pdf", which_plot=c(1:200),which_points=c("Over150m","Under150m"), smoo="loess", ADD=3000,cols=c("black","red"))
search.genes = c("LOC100133583","HLA-DMA","HLA","HLA-DOA","HLA-DOB","HLA-DPA1","HLA-DPB1","HLA-DQA1","HLA-DQA2","HLA-DQB1","HLA-DQB2","HLA-DRA","HLA-DRB1","HLA-DRB3","HLA-DRB4","HLA-DRB5")
search.genes = c("LOC100133583","HLA-DMA","HLA","HLA-DOA","HLA-DOB","HLA-DPA1","HLA-DPB1","HLA-DQA1","HLA-DQA2","HLA-DQB1","HLA-DQB2","HLA-DRA","HLA-DRB1","HLA-DRB3","HLA-DRB4","HLA-DRB5","IL4","CD40LG","CD40","FCER1A","MS4A2","FCER1G","IL9","IL10","IL13","IL5","TNF","IL3","PRG2","RNASE3","EPX","CCL11")
search.genes = c("LOC100133583","HLA-DMA","HLA","HLA-DOA","HLA-DOB","HLA-DPA1","HLA-DPB1","HLA-DQA1","HLA-DQA2","HLA-DQB1","HLA-DQB2","HLA-DRA","HLA-DRB1","HLA-DRB3","HLA-DRB4","HLA-DRB5","IL4","CD40LG","CD40","FCER1A","MS4A2","FCER1G","IL9","IL10","IL13","IL5","TNF","IL3","PRG2","RNASE3","EPX","CCL11","p16", "CYP1A1", "RASSF1A", "FHIT"," MAOB","AXL","PTPRO","AluYb8")
search.genes = c("LOC100133583","HLA-DMA","HLA","HLA-DOA","HLA-DOB","HLA-DPA1","HLA-DPB1","HLA-DQA1","HLA-DQA2","HLA-DQB1","HLA-DQB2","HLA-DRA","HLA-DRB1","HLA-DRB3","HLA-DRB4","HLA-DRB5","IL4","CD40LG","CD40","FCER1A","MS4A2","FCER1G","IL9","IL10","IL13","IL5","TNF","IL3","PRG2","RNASE3","EPX","CCL11","p16", "CYP1A1", "RASSF1A", "FHIT"," MAOB","AXL","PTPRO","AluYb8")
drive
list.files(drive)
autosomal = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/DMRs/Autosomal_Analysis_without_Sex_chromosomes"
currentAsthma = read.csv(file.path(autosomal,"dmrs_currentAsthma_noXY_annotated.csv"))
dist150 = read.csv(file.path(autosomal,"dmrs_dist150_noXY_annotated.csv"))
dist_cont = read.csv(file.path(autosomal,"dmrs_distance_continous_noXY_annotated.csv"))
vitd_cont = read.csv(file.path(autosomal,"dmrs_vitd_noXY_annotated.csv"))
search.genes %in% vitd_cont$Nearest.Feature
currentAsthma$Nearest.Feature = gsub("(+)","",currentAsthma$Nearest.Feature,fixed=TRUE)
currentAsthma$Nearest.Feature = gsub("(-)","",currentAsthma$Nearest.Feature,fixed=TRUE)
View(currentAsthma)
dist_cont$Nearest.Feature = gsub("(+)","",dist_cont$Nearest.Feature,fixed=TRUE)
dist_cont$Nearest.Feature = gsub("(-)","",dist_cont$Nearest.Feature,fixed=TRUE)
vitd_cont$Nearest.Feature = gsub("(+)","",vitd_cont$Nearest.Feature,fixed=TRUE)
vitd_cont$Nearest.Feature = gsub("(-)","",vitd_cont$Nearest.Feature,fixed=TRUE)
dist150$Nearest.Feature = gsub("(+)","",dist150$Nearest.Feature,fixed=TRUE)
dist150$Nearest.Feature = gsub("(-)","",dist150$Nearest.Feature,fixed=TRUE)
search.genes %in% vitd_cont$Nearest.Feature
search.genes %in% dist_cont$Nearest.Feature
dist150$Nearest.Feature
currentAsthma = read.csv(file.path(autosomal,"dmrs_currentAsthma_noXY_annotated.csv"))
currentAsthma$Nearest.Feature = gsub(" (+)","",currentAsthma$Nearest.Feature,fixed=TRUE)
currentAsthma$Nearest.Feature = gsub(" (-)","",currentAsthma$Nearest.Feature,fixed=TRUE)
dist150 = read.csv(file.path(autosomal,"dmrs_dist150_noXY_annotated.csv"))
dist150$Nearest.Feature = gsub(" (+)","",dist150$Nearest.Feature,fixed=TRUE)
dist150$Nearest.Feature = gsub(" (-)","",dist150$Nearest.Feature,fixed=TRUE)
dist_cont = read.csv(file.path(autosomal,"dmrs_distance_continous_noXY_annotated.csv"))
dist_cont$Nearest.Feature = gsub(" (+)","",dist_cont$Nearest.Feature,fixed=TRUE)
dist_cont$Nearest.Feature = gsub(" (-)","",dist_cont$Nearest.Feature,fixed=TRUE)
vitd_cont = read.csv(file.path(autosomal,"dmrs_vitd_noXY_annotated.csv"))
vitd_cont$Nearest.Feature = gsub(" (+)","",vitd_cont$Nearest.Feature,fixed=TRUE)
vitd_cont$Nearest.Feature = gsub(" (-)","",vitd_cont$Nearest.Feature,fixed=TRUE)
search.genes %in% currentAsthma$Nearest.Feature
which(search.genes %in% currentAsthma$Nearest.Feature)
currentAsthma[which(search.genes %in% currentAsthma$Nearest.Feature),]
vitd_cont[which(search.genes %in% vitd_cont$Nearest.Feature),]
currentAsthma[which(search.genes %in% currentAsthma$Nearest.Feature),]
dist150[which(search.genes %in% dist150$Nearest.Feature),]
dist_cont[which(search.genes %in% dist_cont$Nearest.Feature),]
vitd_cont[which(search.genes %in% vitd_cont$Nearest.Feature),]
currentAsthma[which(search.genes %in% currentAsthma$Nearest.Feature),]
search.genes
dist150[which(dist150$Nearest.Feature %in% search.genes),]
currentAsthma[which(currentAsthma$Nearest.Feature %in% search.genes),]
dist150[which(dist150$Nearest.Feature %in% search.genes),]
dist_cont[which(dist_cont$Nearest.Feature %in% search.genes),]
vitd_cont[which(vitd_cont$Nearest.Feature %in% search.genes),]
currentAsthma[which(currentAsthma$Nearest.Feature %in% search.genes),]
dist150[which(dist150$Nearest.Feature %in% search.genes),]
dist_cont[which(dist_cont$Nearest.Feature %in% search.genes),]
vitd_cont[which(vitd_cont$Nearest.Feature %in% search.genes),]
currentAsthma[which(currentAsthma$Nearest.Feature %in% search.genes),]
currentAsthma_common_searchGenes = currentAsthma[which(currentAsthma$Nearest.Feature %in% search.genes),]
write.csv(currentAsthma_common_searchGenes,file = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/DMRs/Autosomal_Analysis_without_Sex_chromosomes/GeneSet_Analysis/currentAsthma_intersect_search_genes.csv")
write.csv(dist150[which(dist150$Nearest.Feature %in% search.genes),],file = "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/DMRs/Autosomal_Analysis_without_Sex_chromosomes/GeneSet_Analysis/dist150_intersect_search_genes.csv")
write.csv(search.genes,file =  "~/Google Drive/Deliverables/Charm-Analysis/AsthmaPeru/Full_analysis/DMRs/Autosomal_Analysis_without_Sex_chromosomes/GeneSet_Analysis/search_genes_from_paper.csv")
currentAsthma_common_searchGenes = currentAsthma[which(currentAsthma$Nearest.Feature %in% search.genes),]$Nearest.Feature
currentAsthma_common_searchGenes = currentAsthma[which(currentAsthma$Nearest.Feature %in% search.genes),]
currentAsthma_common_searchGenes$Nearest.Feature
save(thedmrs_dist,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_continous_noXY.rda")
write.csv(thedmrs_dist$dmrs,file="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_continous_noXY.csv")
table(groups)
quantile(pd$dist)
groups = as.numeric(cut(mod[,coeff],quantile(pd$dist)))
table(groups)
quantile(pd$dist)
groups = as.numeric(cut(mod[,coeff],quantile(pd$dist)))
table(groups)
View(pd)
quantile(pd$dist)
groups = as.numeric(cut(mod[,coeff],quantile(pd$dist)))
table(groups)
cut(mod[,coeff],quantile(pd$dist)
)
mod0 = matrix(1,nrow=nrow(pd),ncol=1)
mod = model.matrix(~1 +pd$dist)
groups = as.numeric(cut(mod[,coeff],quantile(pd$dist)))
table(groups)
groups
groups[28]
groups[28] =1
table(groups)
pd$groups_distance = c("1st Quantile","2nd Quantile","3rd Quantile","4th Quantile")[groups]
table(pd$groups_distance)
plotDMRs(dmrs=thedmrs_dist, Genome=Hsapiens, cpg.islands=cpg.cur, exposure=pd$groups_distance,outfile="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_quantiles_errorCorrect.pdf", which_plot=c(1:200), smoo="loess", ADD=3000,cols=c("black","blue","red","orange"))
save(thedmrs_dist,file = "April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_continous_noXY.rda")
write.csv(thedmrs_dist$dmrs,file="April18_Asthma_peru/results/Autosomal_Analysis_without_Sex_chromosomes/dmrs_distance_continous_noXY.csv")
gc()
fran = read.csv("~/Documents/fran_cox1_v_cox2.csv")
fran
?ttest
t.test(x=fran$cox1,y=fran$cox1.1)
result = t.test(x=fran$cox1,y=fran$cox1.1)
result$statistic
result$p.value
?keep
library(gdata)
?keep
cox2 = read.csv("~/Documents/cox2.csv")
View(cox2)
cox2 = read.csv("~/Documents/cox2_modif.csv")
res_cox2 = t.test(x =cox2$cox2.uexp,y=cox2$coxe.exp)
res_cox2
cox1 = read.csv("~/Documents/cox1_modif.csv.csv")
cox1 = read.csv("~/Documents/cox1_modif.csv")
res_cox1 = t.test(x =cox1$cox1.uexp,y=cox1$cox1.exp)
cox1$cox1.uexp
View(cox1)
res_cox1 = t.test(x =cox1$cox1.unexp,y=cox1$cox1.exp)
res_cox1
cox2_notmodified = read.csv("~/Documents/cox2.csv")
res_cox2_notmodified = t.test(x = cox2_notmodified$cox2.unexp,y=cox2_notmodified$cox2.exp)
res
res_cox2_notmodified
getwd()
###################################################
### Setting the working directory, in my case
setwd("~/Documents/GitHub/GeneExpressionDataAnalysis/affyData/")
###################################################
###Check the data
date()
###################################################
### Clear the workspace, note the two "embedded" function
rm(list=ls())
###################################################
### Load libraries needed for the analysis
require(affy)
require(hgu95a.db)
###################################################
### Load data previously save
load("./objs/affyData.rda")
###################################################
### The workspace content
ls()
###################################################
### Check classes
class(dat)
class(dat.rma)
###################################################
### Slots/elements contained in the two classes can be seen using:
### NOTE: SLOT NAMES USUALLY WORK AS ACCESSORS
slotNames(dat)
slotNames(dat.rma)
### This extract normalized and summarized gene expression
dat.expr <- exprs(dat.rma)
dim(dat.expr)
### This extract phenotypic information
pData(dat.rma)
### This extract features information
annotation(dat.rma)
### This extract perfect match probe intensities
dat.pm <- pm(dat)
dim(dat.pm)
### This extract mismatch probe intensities
annotation(dat.rma)
dat.pm <- pm(dat)
require(affy)
require(hgu95a.db)
dat.pm <- pm(dat)
dim(dat.pm)
dat
pm(dat)
dat.pm <- pm(dat.rma)
dat.mm <- mm(dat)
dim(dat.mm)
biocLite("affy")
rm(list=ls())
biocLite("affy")
